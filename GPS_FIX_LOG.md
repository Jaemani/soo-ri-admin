# GPS ë°ì´í„° ì¡°íšŒ ë¬¸ì œ í•´ê²° ë¡œê·¸

## ğŸ› ë¬¸ì œ ìƒí™©

### **ì¦ìƒ**
- ì„¼ì„œ IDë¥¼ ì¶”ê°€í–ˆëŠ”ë°ë„ ì£¼í–‰ê±°ë¦¬ê°€ 0kmë¡œ í‘œì‹œë¨
- ë¦¬í¬íŠ¸ë¥¼ ì‚­ì œí•˜ê³  ì¬ìƒì„±í•´ë„ ë™ì¼í•œ ë¬¸ì œ ë°œìƒ
- ì‚¬ìš©ì ì •ë³´: `sensorId: "450088830181480"` ì •ìƒ ì¶”ê°€ë¨

### **ì‚¬ìš©ì ë°ì´í„°**
```javascript
{
  firebaseUid: "HpErhmIUaoc2q2v9yxkXjji375y2",
  name: "í…ŒìŠ¤íŠ¸ ê³„ì • 4",
  phoneNumber: "+821012341234",
  sensorId: "450088830181480",  // âœ… ì •ìƒ ì¶”ê°€ë¨
  supportedDistrict: "ì„±ë™êµ¬"
}
```

---

## ğŸ” ì›ì¸ ë¶„ì„

### **1. GPS API ë‚ ì§œ í˜•ì‹ ì˜¤ë¥˜**

**API ëª…ì„¸ ìš”êµ¬ì‚¬í•­**:
```
RD_DT: "20251207" (YYYYMMDD í˜•ì‹, í•˜ì´í”ˆ ì—†ìŒ)
```

**ê¸°ì¡´ ì½”ë“œ (ì˜ëª»ë¨)**:
```javascript
// gpsDataFetcher.js Line 66
const dateStr = date.toISOString().split('T')[0]; // "2025-12-07" âŒ
```

**ë¬¸ì œì **:
- APIëŠ” `20251207` í˜•ì‹ì„ ìš”êµ¬
- ì½”ë“œëŠ” `2025-12-07` í˜•ì‹ìœ¼ë¡œ ì „ì†¡
- APIê°€ ë‚ ì§œë¥¼ ì¸ì‹í•˜ì§€ ëª»í•´ ë¹ˆ ê²°ê³¼ ë°˜í™˜

---

## âœ… í•´ê²° ë°©ë²•

### **ìˆ˜ì •ëœ ì½”ë“œ**:
```javascript
// gpsDataFetcher.js Line 67
const dateStr = date.toISOString().split('T')[0].replace(/-/g, ''); // "20251207" âœ…
```

**ë³€ê²½ ì‚¬í•­**:
- `.replace(/-/g, '')` ì¶”ê°€í•˜ì—¬ í•˜ì´í”ˆ ì œê±°
- `2025-12-07` â†’ `20251207` ë³€í™˜

---

## ğŸ¨ UI ê°œì„  ì‚¬í•­

### **1. í•˜ì–€ ê¸€ì”¨ ë¬¸ì œ í•´ê²°**

**ë¬¸ì œ**:
- ì›í˜• ì°¨íŠ¸ ì•ˆì˜ ìˆ«ìì™€ "ì " ë¼ë²¨ì´ í•˜ì–€ìƒ‰
- ë°°ê²½ë„ ë°ì€ ìƒ‰ì´ë¼ ê°€ë…ì„± ë§¤ìš° ë‚®ìŒ

**í•´ê²°**:
```javascript
// Before
color: white;

// After
color: #1A1A1A;
text-shadow: 0 2px 4px rgba(255, 255, 255, 0.3);
```

### **2. ì ìˆ˜ ì‚°ì • ê·¼ê±° ì¶”ê°€**

**ì¶”ê°€ëœ ì„¹ì…˜**:
```
ğŸ“Š ì ìˆ˜ ì‚°ì • ê·¼ê±°
ì£¼í–‰ê±°ë¦¬: XXkm
ì´ë™ ì¶”ì„¸: ì•ˆì • ìœ ì§€ â¡ï¸
  ìµœê·¼ 7ì¼ê°„ ì´ë™ëŸ‰ì´ ì¼ì •í•©ë‹ˆë‹¤
ìµœê·¼ ìˆ˜ë¦¬: XíšŒ
ìê°€ì ê²€: XíšŒ
```

### **3. ì¶”ì„¸ í‘œì‹œ ê°œì„ **

**Before**:
- "ì•ˆì •" (ì˜ë¯¸ ë¶ˆëª…í™•)

**After**:
- "ì•ˆì • ìœ ì§€ â¡ï¸" (ì´ëª¨ì§€ ì¶”ê°€)
- "ìµœê·¼ 7ì¼ê°„ ì´ë™ëŸ‰ì´ ì¼ì •í•©ë‹ˆë‹¤" (ì„¤ëª… ì¶”ê°€)

**ì¶”ì„¸ ì¢…ë¥˜**:
- `increase`: "ì¦ê°€ ì¶”ì„¸ ğŸ“ˆ" - "ìµœê·¼ ì´ë™ëŸ‰ì´ ì¦ê°€í•˜ê³  ìˆìŠµë‹ˆë‹¤"
- `decrease`: "ê°ì†Œ ì¶”ì„¸ ğŸ“‰" - "ìµœê·¼ ì´ë™ëŸ‰ì´ ê°ì†Œí•˜ê³  ìˆìŠµë‹ˆë‹¤"
- `stable`: "ì•ˆì • ìœ ì§€ â¡ï¸" - "ìµœê·¼ 7ì¼ê°„ ì´ë™ëŸ‰ì´ ì¼ì •í•©ë‹ˆë‹¤"

**ì¶”ì„¸ ê³„ì‚° ë¡œì§**:
```javascript
// gpsDataFetcher.js
const recentAvg = ìµœê·¼ 3ì¼ í‰ê· ;
const olderAvg = ì´ì „ 4ì¼ í‰ê· ;

if (recentAvg > olderAvg * 1.2) trend = 'increase';      // 20% ì´ìƒ ì¦ê°€
else if (recentAvg < olderAvg * 0.8) trend = 'decrease'; // 20% ì´ìƒ ê°ì†Œ
else trend = 'stable';                                    // ê·¸ ì™¸
```

---

## ğŸš€ ë°°í¬ ì™„ë£Œ

### **Functions ë°°í¬**:
```bash
firebase deploy --only functions:api
```

**ë°°í¬ ì‹œê°„**: ~2ë¶„  
**ìƒíƒœ**: âœ… ì„±ê³µ  
**URL**: `https://asia-northeast3-soo-ri.cloudfunctions.net/api`

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### **1. ê¸°ì¡´ ë¦¬í¬íŠ¸ ì‚­ì œ**
```
Firebase Console â†’ Firestore
â†’ user_welfare_reports â†’ {userId} â†’ ë¬¸ì„œ ì‚­ì œ
```

### **2. ì•±ì—ì„œ ë¦¬í¬íŠ¸ ì¬ìƒì„±**
```
1. ì•± ìƒˆë¡œê³ ì¹¨
2. "ë¦¬í¬íŠ¸ ìƒì„±í•˜ê¸°" ë²„íŠ¼ í´ë¦­
3. 5-10ì´ˆ ëŒ€ê¸°
```

### **3. ì˜ˆìƒ ê²°ê³¼**
```
âœ… ì£¼í–‰ê±°ë¦¬: ì‹¤ì œ GPS ë°ì´í„° (ì˜ˆ: 45.2km)
âœ… ì´ë™ ì¶”ì„¸: ì¦ê°€/ê°ì†Œ/ì•ˆì • (ì‹¤ì œ ë¶„ì„)
âœ… ê±´ê°• ì ìˆ˜: ì‹¤ì œ ê³„ì‚° (0-100ì )
```

### **4. ë¡œê·¸ í™•ì¸**
```
Firebase Console â†’ Functions â†’ Logs
â†’ "ğŸ“ Fetching GPS data for sensor: 450088830181480"
â†’ "âœ… GPS data fetched: XX records"
â†’ "âœ… GPS data retrieved: { totalDistance: XX.X, trend: 'stable' }"
```

---

## ğŸ“Š GPS API ì‘ë‹µ ì˜ˆì‹œ

### **ìš”ì²­**:
```json
POST https://test-web2.star-pickers.com/v2/vehicle/mileage
{
  "RD_DT": "20251207",
  "SNR_ID": "450088830181480"
}
```

### **ì‘ë‹µ**:
```json
{
  "STATUS": "SUCCESS",
  "RESULT": [
    {
      "SNR_ID": "450088830181480",
      "RD_DT": "20251207",
      "TOT_TM": 120,      // ì´ ì‹œê°„ (ë¶„)
      "TOT_DTN": 15.5,    // ì´ ê±°ë¦¬ (km)
      "AVG_SPD": 7.75     // í‰ê·  ì†ë„ (km/h)
    }
  ]
}
```

---

## ğŸ¯ í•µì‹¬ ë³€ê²½ ì‚¬í•­ ìš”ì•½

| í•­ëª© | Before | After |
|------|--------|-------|
| ë‚ ì§œ í˜•ì‹ | `2025-12-07` âŒ | `20251207` âœ… |
| ì›í˜• ì°¨íŠ¸ ê¸€ì”¨ | `white` âŒ | `#1A1A1A` âœ… |
| ì¶”ì„¸ í‘œì‹œ | "ì•ˆì •" | "ì•ˆì • ìœ ì§€ â¡ï¸" |
| ì¶”ì„¸ ì„¤ëª… | ì—†ìŒ | "ìµœê·¼ 7ì¼ê°„ ì´ë™ëŸ‰ì´ ì¼ì •í•©ë‹ˆë‹¤" |
| ì ìˆ˜ ê·¼ê±° | ì—†ìŒ | 4ê°œ í•­ëª© ìƒì„¸ í‘œì‹œ |

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] GPS API ë‚ ì§œ í˜•ì‹ ìˆ˜ì •
- [x] Functions ë°°í¬
- [x] í•˜ì–€ ê¸€ì”¨ ìƒ‰ìƒ ìˆ˜ì •
- [x] ì ìˆ˜ ì‚°ì • ê·¼ê±° ì¶”ê°€
- [x] ì¶”ì„¸ í‘œì‹œ ê°œì„ 
- [x] ì¶”ì„¸ ì„¤ëª… ì¶”ê°€
- [x] ë¬¸ì„œí™” ì™„ë£Œ

---

## ğŸ”® í–¥í›„ ê°œì„  ì‚¬í•­

### **ë‹¨ê¸°**
1. GPS ë°ì´í„° ìºì‹± (ë™ì¼ ë‚ ì§œ ì¤‘ë³µ ì¡°íšŒ ë°©ì§€)
2. ì—ëŸ¬ ë¡œê¹… ê°•í™” (Sentry ì—°ë™)
3. ë¦¬í¬íŠ¸ ìƒì„± ì§„í–‰ë¥  í‘œì‹œ

### **ì¤‘ê¸°**
1. ì‹¤ì‹œê°„ GPS ë°ì´í„° ì—…ë°ì´íŠ¸
2. ì£¼ê°„/ì›”ê°„ ì¶”ì„¸ ê·¸ë˜í”„
3. ì„¼ì„œ ID ìë™ ë§¤í•‘ ì‹œìŠ¤í…œ

---

**ì‘ì„±ì¼**: 2025ë…„ 12ì›” 7ì¼ 00:29  
**ì‘ì„±ì**: Cascade AI  
**ë²„ì „**: 1.0.0
